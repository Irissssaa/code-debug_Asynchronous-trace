## 基于GDB的Rust异步函数调试方法

### 队伍信息

- 学校院系：北京工商大学计算机系；
- 队员：曾小红，张弈帆，董嘉誉；
- 指导老师：吴竞邦；
- 队伍ID：T202510011995491；
- 队伍名：Async_Avengers；
- 赛题：proj158 支持Rust语言的源代码级内核调试工具；

### 项目描述

针对Rust语言的异步函数调用跟踪与调试难以及已有方法通用性差的问题，本项目设计基于GDB的白名单动态函数插桩跟踪与调试方法。我们旨在完成以下四个目标：

- 目标 1：实现异步代码的静态依赖关系解析；
- 目标 2：实现“白名单”式按需追踪；
- 目标 3：实现基于 GDB 非侵入式动态插桩与模块化数据采集框架；
- 目标 4：实现多维度的异步行为可视化分析；

### 本仓库结构

```
├── docs/                     # 存放项目相关说明文档，包括参赛文档、实现思路、使用方法等
├── dwarf_analyzer/           # 初版DWARF 调试信息解析模块
├── gdb_profiler/             # 性能分析工具
├── results/                  # 存放分析工具生成的中间文件和最终结果，如 .json, .dot, .svg 文件
├── src/                      # 项目核心源代码目录
│   ├── core/                 # 存放与具体调试目标无关的核心、通用逻辑
│   │   ├── dwarf/            # DWARF 调试信息解析模块
│   │   ├── runtime_plugins/  # 存放具体的运行时插件，用于组合和配置 Tracers
│   │   ├── tracers/          # 存放具体的追踪探针，每个 Tracer 负责一种特定的数据采集任务
│   │   ├── __init__.py       # GDB 动态插桩框架的核心实现，包含断点、插件加载等逻辑
│   │   ├── config.py         # 项目配置文件，如指定当前要加载的运行时插件
│   │   ├── find_poll_fn.py   # 实现 find-poll-fn GDB 命令，用于查找所有 poll 函数
│   │   └── init_dwarf_analysis.py # 实现 init-dwarf-analysis GDB 命令，用于初始化 DWARF 解析树
│   ├── tokio/                  # 存放与 Tokio 运行时相关的特定分析逻辑或插件
│   ├── main.py                 # GDB 脚本的总入口，负责导入所有模块和命令
│   └── requirements.txt        # 项目的 Python 依赖库列表
├── tests/                    # 存放用于测试本工具功能的 Rust 测试项目
└── README.md                 # 项目的顶层说明文档

```

### 参赛文档
我们的参赛文档在[这里](https://gitlab.eduxiji.net/T202510011995491/project2721707-300492/-/blob/master/docs/Proj158_%E6%94%AF%E6%8C%81Rust%E8%AF%AD%E8%A8%80%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81%E7%BA%A7%E5%86%85%E6%A0%B8%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7.pdf)

### 工作日志

我们团队的工作日志在[这里](https://github.com/Irissssaa/code-debug_Asynchronous-trace/discussions)

### 项目进度

| 目标 | 完成情况 | 说明                                                         |
| :--: | :------: | :----------------------------------------------------------- |
|  1   |   完成   | ✓ 实现 GDB Python 脚本插件加载机制<br />✓ 实现自动在函数进入和返回处打断点的插件<br />✓ 实现在断点触发后自动收集异步函数运行状态的插件<br />✓ 实现从异步函数名对应到 poll 函数的插件2完成 |
|  2   | 完成 | ✓ objdump 输出信息解析<br />✓ 用 GDB 代替 objdump<br /> ✓ 构建异步函数依赖关系树<br />✓ 解析源代码中异步函数和符号表中poll函数的对应关系 |
|  3   |  完成  | ✓实现异步程序跟踪框架（方便的异步运行时插桩，方便的异步运行时状态获取功能）<br />✓ 实现tracer（函数参数、全局/本地变量，栈回溯获取等）<br /> ✓ 内核态适配（拟embassy）<br /> ✓ 用户态适配（tokio） |
|  4   |   完成   | ✓ 利用 GDB 插桩功能生成和绘制火焰图相关的事件<br />✓ Chrome Trace Event 格式 json 输出 |

